(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{29:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(21),s=n.n(o),r=n(10),i=(n(29),n(23)),l=n(2),u=n(3),m=n(5),b=n(24),d=n(0),j=["component"],p=function(e){var t=e.component,n=Object(b.a)(e,j);return Object(d.jsx)(u.b,{children:function(){return!0===n.loggedIn?Object(d.jsx)(t,Object(m.a)({},n)):Object(d.jsx)(u.a,{to:"./sign-in"})}})},_=n.p+"static/media/logo.5f3664ca.svg";var h=function(e){var t=e.children;return Object(d.jsxs)("header",{className:"header",children:[Object(d.jsx)("img",{src:_,alt:"\u041c\u0435\u0441\u0442\u043e",className:"header__logo"}),t]})},f=c.a.createContext();var O=function(e){var t=e.card,n=c.a.useContext(f),a=t.owner._id===n._id,o="card__remove-button ".concat(a?"element__remove-button_visible":"element__remove-button_hidden"),s=t.likes.some((function(e){return e._id===n._id})),r="".concat(s?"like__button_active":"like__button_inactive");return Object(d.jsx)("li",{className:"elements__list-item",children:Object(d.jsxs)("article",{className:"element",children:[Object(d.jsxs)("div",{className:"element__square-container",children:[Object(d.jsx)("img",{src:t.link,alt:t.name,className:"element__image",onClick:function(){e.onCardClick(t)}}),Object(d.jsx)("button",{className:"element__remove-button button ".concat(o),onClick:function(){e.onCardDelete(t)}})]}),Object(d.jsx)("h2",{className:"element__title",children:t.name}),Object(d.jsxs)("div",{className:"like",children:[Object(d.jsx)("button",{type:"button",className:"like__button button ".concat(r),onClick:function(){e.onCardLike(t)}}),Object(d.jsx)("span",{className:"like__counter",children:t.likes.length})]})]})})};function v(e){return Object(d.jsx)("main",{className:"loader",children:Object(d.jsx)("div",{className:"loader__animation"})})}var x=function(e){var t=e.cards,n=e.onCardLike,a=e.onCardDelete,o=e.onCardClick,s=e.onEditProfile,i=e.onEditAvatar,l=e.onAddPlace,u=e.onLogout,m=e.userEmail,b=e.isLoaded,j=c.a.useContext(f);return b?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)(h,{children:[Object(d.jsx)("p",{className:"header__email",children:m}),Object(d.jsx)(r.b,{to:"/sign-in",onClick:u,className:"header__link link",children:"\u0412\u044b\u0439\u0442\u0438"})]}),Object(d.jsxs)("main",{className:"content",children:[Object(d.jsxs)("section",{className:"profile",children:[Object(d.jsx)("button",{onClick:i,className:"button profile__avatar-button",children:Object(d.jsx)("img",{src:j.avatar,alt:" ",className:"profile__avatar"})}),Object(d.jsxs)("div",{className:"profile__info",children:[Object(d.jsx)("h1",{className:"profile__title",children:j.name}),Object(d.jsx)("button",{onClick:s,className:"profile__edit-button button"}),Object(d.jsx)("p",{className:"profile__subtitle",children:j.about})]}),Object(d.jsx)("button",{onClick:l,type:"button",className:"profile__add-button button"})]}),Object(d.jsx)("section",{className:"elements","aria-label":"\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043c\u0435\u0441\u0442",children:Object(d.jsx)("ul",{className:"elements__list",children:t.map((function(e){return Object(d.jsx)(O,{card:e,onCardClick:o,onCardLike:n,onCardDelete:a},e._id)}))})})]})]}):Object(d.jsx)(v,{})};var g=function(){var e=(new Date).getFullYear();return Object(d.jsxs)("footer",{className:"footer",children:["\xa9 ",e," Mesto Russia"]})};var N=function(e){var t=e.card,n=e.isOpen,a=e.onClose;return Object(d.jsx)("div",{className:"popup popup_content_place-image ".concat(n?"popup_opened":""),children:Object(d.jsxs)("div",{className:"popup__container popup__container_content_place-image",children:[Object(d.jsx)("button",{onClick:a,className:"popup__close button"}),Object(d.jsxs)("figure",{className:"view-fullscreen",children:[Object(d.jsx)("img",{src:null===t||void 0===t?void 0:t.link,alt:null===t||void 0===t?void 0:t.name,className:"view-fullscreen__image"}),Object(d.jsxs)("figcaption",{className:"view-fullscreen__caption",children:[null===t||void 0===t?void 0:t.name," \u2014 ",null===t||void 0===t?void 0:t.owner.name,", ",null===t||void 0===t?void 0:t.owner.about]})]})]})})},k=n(9);var C=function(e){return Object(d.jsx)("div",{className:"popup popup_content_".concat(e.name," ").concat(e.isOpen?"popup_opened":""),children:Object(d.jsxs)("div",{className:"popup__container",children:[Object(d.jsx)("button",{onClick:e.onClose,className:"popup__close button"}),Object(d.jsxs)("form",{className:"form",name:"".concat(e.name,"-form"),onSubmit:e.onSubmit,children:[Object(d.jsx)("h2",{className:"form__title",children:e.title}),e.children,Object(d.jsx)("button",{type:"submit",className:"form__submit-button button",children:e.buttonText})]})]})})};function y(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateUser,o=Object(a.useState)({name:"",about:""}),s=Object(l.a)(o,2),r=s[0],i=s[1],u=Object(a.useContext)(f);Object(a.useEffect)((function(){i({name:u.name||"",about:u.about||""})}),[u,t]);var b=function(e){var t=e.target,n=t.value,a=t.name;i(Object(m.a)(Object(m.a)({},r),{},Object(k.a)({},a,n)))};return Object(d.jsxs)(C,{name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:r.name,about:r.about})},children:[Object(d.jsxs)("label",{htmlFor:"name-input",className:"form__label",children:[Object(d.jsx)("input",{type:"text",name:"name",value:r.name,id:"name-input",placeholder:"\u0418\u043c\u044f",className:"form__input",minLength:"2",maxLength:"40",required:!0,onChange:b}),Object(d.jsx)("span",{className:"form__input-error form__input-error_visible name-input-error"})]}),Object(d.jsxs)("label",{htmlFor:"about-input",className:"form__label",children:[Object(d.jsx)("input",{type:"text",name:"about",value:r.about,id:"about-input",placeholder:"\u0417\u0430\u043d\u044f\u0442\u0438\u0435",className:"form__input",minLength:"2",maxLength:"200",required:!0,onChange:b}),Object(d.jsx)("span",{className:"form__input-error form__input-error_visible about-input-error"})]})]})}var S=n(15),w=n(16),L=new(function(){function e(t){Object(S.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(w.a)(e,[{key:"_request",value:function(e){return fetch(this._baseUrl+e.path,{method:e.method,headers:this._headers,body:e.body}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status,": ").concat(e.message))}))}},{key:"getUser",value:function(){return this._request({method:"GET",path:"users/me"})}},{key:"getInitialCards",value:function(){return this._request({method:"GET",path:"cards"})}},{key:"updateUser",value:function(e){return this._request({method:"PATCH",path:"users/me",body:JSON.stringify(e)})}},{key:"createCard",value:function(e){return this._request({method:"POST",path:"cards",body:JSON.stringify(e)})}},{key:"deleteCard",value:function(e){return this._request({method:"DELETE",path:"cards/".concat(e)})}},{key:"likeCard",value:function(e){return this._request({method:"PUT",path:"cards/likes/".concat(e)})}},{key:"unlikeCard",value:function(e){return this._request({method:"DELETE",path:"cards/likes/".concat(e)})}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.likeCard(e):this.unlikeCard(e)}},{key:"changeAvatar",value:function(e){return this._request({method:"PATCH",path:"users/me/avatar",body:JSON.stringify(e)})}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-25/",headers:{authorization:"04f57d96-9414-4d3f-8e70-9d8b878ddf47","Content-Type":"application/json"}}),E=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(S.a)(this,e),this.baseUrl=n,this.headers=a}return Object(w.a)(e,[{key:"_request",value:function(e){var t=e.endpoint,n=e.req;return fetch(this.baseUrl+t,n).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status,": ").concat(e.statusText))}))}},{key:"signUp",value:function(e){var t=e.password,n=e.email;return this._request({endpoint:"/signup",req:{method:"POST",headers:this.headers,body:JSON.stringify({password:t,email:n})}})}},{key:"signIn",value:function(e){return this._request({endpoint:"/signin",req:{method:"POST",headers:this.headers,body:JSON.stringify(e)}}).catch((function(e){return console.log(e)}))}},{key:"checkToken",value:function(e){return this._request({endpoint:"/users/me",req:{method:"GET",headers:Object(m.a)(Object(m.a)({},this.headers),{},{Authorization:"Bearer ".concat(e)})}})}}]),e}())({baseUrl:"https://auth.nomoreparties.co",headers:{"Content-Type":"application/json"}});function q(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateAvatar,o=Object(a.useRef)("");return Object(d.jsx)(C,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonText:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({avatar:o.current.value})},children:Object(d.jsxs)("label",{htmlFor:"avatar-link-input",className:"form__label",children:[Object(d.jsx)("input",{ref:o,type:"url",name:"avatar",id:"avatar-link-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__input",required:!0}),Object(d.jsx)("span",{className:"form__input-error form__input-error_visible avatar-link-input-error"})]})})}function T(e){var t=e.isOpen,n=e.onClose,c=e.onAddPlace,o=Object(a.useState)({name:"",link:""}),s=Object(l.a)(o,2),r=s[0],i=s[1];Object(a.useEffect)((function(){i({name:"",link:""})}),[t]);var u=function(e){var t=e.target,n=t.value,a=t.name;i(Object(m.a)(Object(m.a)({},r),{},Object(k.a)({},a,n)))};return Object(d.jsxs)(C,{name:"add-card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonText:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c(r)},children:[Object(d.jsxs)("label",{htmlFor:"place-name-input",className:"form__label",children:[Object(d.jsx)("input",{type:"text",name:"name",value:r.name,onChange:u,id:"place-name-input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"form__input",minLength:"2",required:!0}),Object(d.jsx)("span",{className:"form__input-error form__input-error_visible place-name-input-error"})]}),Object(d.jsxs)("label",{htmlFor:"place-link-input",className:"form__label",children:[Object(d.jsx)("input",{type:"url",name:"link",value:r.link,onChange:u,id:"place-link-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__input",required:!0}),Object(d.jsx)("span",{className:"form__input-error form__input-error_visible place-link-input-error"})]})]})}function U(e){var t=e.card,n=e.isOpen,a=e.onClose,c=e.onConfirm;return Object(d.jsx)(C,{name:"confirmation",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:"\u0414\u0430",isOpen:n,onClose:a,onSubmit:function(e){e.preventDefault(),c(t)}})}function P(e){var t=e.title,n=e.buttonText,c=e.onLogin,o=Object(a.useState)({email:"",password:""}),s=Object(l.a)(o,2),r=s[0],i=s[1],u=function(e){var t=e.target,n=t.name,a=t.value;i(Object(m.a)(Object(m.a)({},r),{},Object(k.a)({},n,a)))};return Object(d.jsx)("main",{className:"content",children:Object(d.jsxs)("form",{className:"form auth__form",onSubmit:function(e){e.preventDefault(),c(r)},children:[Object(d.jsx)("h2",{className:"form__title auth__title",children:t}),Object(d.jsxs)("label",{htmlFor:"email-input",className:"form__label",children:[Object(d.jsx)("input",{type:"email",name:"email",value:r.email,id:"email-input",placeholder:"Email",className:"form__input auth__input",required:!0,onChange:u}),Object(d.jsx)("span",{className:"form__input-error form__input-error_visible name-input-error"})]}),Object(d.jsxs)("label",{htmlFor:"about-input",className:"form__label",children:[Object(d.jsx)("input",{type:"password",name:"password",value:r.password,id:"pessword-input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"form__input auth__input",minLength:"5",maxLength:"30",required:!0,onChange:u}),Object(d.jsx)("span",{className:"form__input-error form__input-error_visible about-input-error"})]}),Object(d.jsx)("button",{type:"submit",className:"form__submit-button auth__button button",children:n})]})})}function F(e){var t=e.title,n=e.buttonText,c=e.onRegister,o=Object(a.useState)({email:"",password:""}),s=Object(l.a)(o,2),i=s[0],u=s[1],b=function(e){var t=e.target,n=t.name,a=t.value;u(Object(m.a)(Object(m.a)({},i),{},Object(k.a)({},n,a)))};return Object(d.jsx)("main",{className:"content",children:Object(d.jsxs)("form",{className:"form auth__form",onSubmit:function(e){e.preventDefault(),c(i)},children:[Object(d.jsx)("h2",{className:"form__title auth__title",children:t}),Object(d.jsxs)("label",{htmlFor:"email-input",className:"form__label",children:[Object(d.jsx)("input",{type:"email",name:"email",value:i.email,id:"email-input",placeholder:"Email",className:"form__input auth__input",required:!0,onChange:b}),Object(d.jsx)("span",{className:"form__input-error form__input-error_visible name-input-error"})]}),Object(d.jsxs)("label",{htmlFor:"about-input",className:"form__label",children:[Object(d.jsx)("input",{type:"password",name:"password",value:i.password,id:"pessword-input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"form__input auth__input",minLength:"5",maxLength:"30",required:!0,onChange:b}),Object(d.jsx)("span",{className:"form__input-error form__input-error_visible about-input-error"})]}),Object(d.jsx)("button",{type:"submit",className:"form__submit-button auth__button button",children:n}),Object(d.jsxs)("p",{className:"auth__subtitle",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(d.jsx)(r.b,{to:"/sign-in",className:"auth__link link",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})}function D(e){var t=e.data,n=e.isOpen,a=e.onClose;return Object(d.jsx)("div",{className:"popup popup_content_tooltip ".concat(n?"popup_opened":""),children:Object(d.jsxs)("div",{className:"popup__container popup__container_content_tooltip",children:[Object(d.jsx)("button",{onClick:a,className:"popup__close button"}),Object(d.jsx)("img",{src:t.icon,alt:"\u0418\u043a\u043e\u043d\u043a\u0430 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",className:"popup__icon"}),Object(d.jsx)("p",{className:"popup__message",children:t.message})]})})}var A=n.p+"static/media/tooltip-ok.e004e6e7.svg",I=n.p+"static/media/tooltip-error.471086c8.svg";var J=Object(u.h)((function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(!1),s=Object(l.a)(o,2),m=s[0],b=s[1],j=Object(a.useState)(!1),_=Object(l.a)(j,2),O=_[0],v=_[1],k=Object(a.useState)(!1),C=Object(l.a)(k,2),S=C[0],w=C[1],J=Object(a.useState)(!1),R=Object(l.a)(J,2),B=R[0],G=R[1],z=Object(a.useState)(!1),H=Object(l.a)(z,2),M=H[0],Y=H[1],K=Object(a.useState)({icon:"",message:""}),Q=Object(l.a)(K,2),V=Q[0],W=Q[1],X=Object(a.useState)(null),Z=Object(l.a)(X,2),$=Z[0],ee=Z[1],te=Object(a.useState)({}),ne=Object(l.a)(te,2),ae=ne[0],ce=ne[1],oe=Object(a.useState)(""),se=Object(l.a)(oe,2),re=se[0],ie=se[1],le=Object(a.useState)(!1),ue=Object(l.a)(le,2),me=ue[0],be=ue[1],de=Object(a.useState)([]),je=Object(l.a)(de,2),pe=je[0],_e=je[1],he=Object(a.useState)(!1),fe=Object(l.a)(he,2),Oe=fe[0],ve=fe[1],xe=Object(u.g)();Object(a.useEffect)((function(){var e=localStorage.getItem("jwt");e&&E.checkToken(e).then((function(e){Ne(e.data.email)})).catch((function(e){return console.log(e)})),Promise.all([L.getUser(),L.getInitialCards()]).then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];ce(n),_e(a)})).catch((function(e){return console.log(e)})).finally((function(){return ve(!0)}))}),[]),Object(a.useEffect)((function(){var e=function(e){"Escape"===e.key&&ge()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[]),Object(a.useEffect)((function(){var e=function(e){e.target.classList.contains("popup_opened")&&ge()};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}),[]);var ge=function(){v(!1),c(!1),b(!1),w(!1),G(!1),Y(!1),ee(null)},Ne=function(e){ie(e),be(!0),xe.push("/")};return Object(d.jsx)("div",{className:"page",children:Object(d.jsxs)(f.Provider,{value:ae,children:[Object(d.jsxs)(u.d,{children:[Object(d.jsxs)(u.b,{path:"/sign-up",children:[Object(d.jsx)(h,{children:Object(d.jsx)(r.b,{to:"/sign-in",className:"header__link link",children:"\u0412\u043e\u0439\u0442\u0438"})}),Object(d.jsx)(F,{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",onRegister:function(e){E.signUp(e).then((function(e){(null===e||void 0===e?void 0:e.data)&&(ie(e.data.email),W({icon:A,message:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"}),Y(!0),xe.push("/"))})).catch((function(e){W({icon:I,message:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}),Y(!0),console.log(e)}))}})]}),Object(d.jsxs)(u.b,{path:"/sign-in",children:[Object(d.jsx)(h,{children:Object(d.jsx)(r.b,{to:"/sign-up",className:"header__link link",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}),Object(d.jsx)(P,{title:"\u0412\u0445\u043e\u0434",buttonText:"\u0412\u043e\u0439\u0442\u0438",onLogin:function(e){E.signIn(e).then((function(e){(null===e||void 0===e?void 0:e.token)&&(localStorage.setItem("jwt",e.token),xe.push("/"))})).then((function(){ie(e.email),be(!0)})).catch((function(e){return console.log(e)}))}})]}),Object(d.jsx)(p,{path:"/",loggedIn:me,cards:pe,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===ae._id}));L.changeLikeCardStatus(e._id,!t).then((function(t){_e((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){ee(e),G(!0)},onEditProfile:function(){c(!0)},onAddPlace:function(){b(!0)},onEditAvatar:function(){v(!0)},onCardClick:function(e){ee(e),w(!0)},onLogout:function(){localStorage.removeItem("jwt"),ie("")},isLoaded:Oe,userEmail:re,component:x})]}),Object(d.jsx)(g,{}),Object(d.jsx)(y,{isOpen:n,onClose:ge,onUpdateUser:function(e){L.updateUser(e).then((function(e){ce(e),ge()})).catch((function(e){return console.log(e)}))}}),Object(d.jsx)(q,{isOpen:O,onUpdateAvatar:function(e){L.changeAvatar(e).then((function(e){ce(e),ge()})).catch((function(e){return console.log(e)}))},onClose:ge}),Object(d.jsx)(T,{isOpen:m,onClose:ge,onAddPlace:function(e){L.createCard(e).then((function(e){_e((function(t){return[e].concat(Object(i.a)(t))})),ge()})).catch((function(e){return console.log(e)}))}}),Object(d.jsx)(U,{card:$,isOpen:B,onClose:ge,onConfirm:function(e){L.deleteCard(e._id).then((function(){_e((function(t){return t.filter((function(t){return t._id!==e._id}))})),ge()})).catch((function(e){return console.log(e)}))}}),Object(d.jsx)(N,{isOpen:S,card:$,onClose:ge}),Object(d.jsx)(D,{isOpen:M,data:V,onClose:ge})]})})})),R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),o(e),s(e)}))};s.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(r.a,{children:Object(d.jsx)(J,{})})}),document.getElementById("root")),R()}},[[39,1,2]]]);
//# sourceMappingURL=main.b9bc55a2.chunk.js.map